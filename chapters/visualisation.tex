% !TeX encoding = UTF-8
% !TeX spellcheck = en_GB
% !TeX root = ../thesis.tex

\NewDocumentCommand{\codeword}{v}{%
	\texttt{#1}%}
	%\textcolor{blue}{
}

\chapter{Tracing and Visualization}
\label{chapter:tracing}
In this section we describe how we retrieve tracing data from the simulation, output the tracing data to files in a specific format, parse this format with other programs/languages for further analysis and how we visualize the simulation using external software.

\section{Basic Metrics of the Packet Flows}
The main source of our data are the Flow Summary Files. They are created manually by our function \codeword{traceMetricsSummary} in the tracing file.
Using the \codeword{ns3::FlowMonitor} we collect the following data:
\begin{itemize}
	\item Total number of transmitted packets for the flow (Tx Packets)
	\item Total number of transmitted bytes for the flow (Tx Bytes)
	\item Rate of transmitted bits for the flow (TxOffered)
	\item Total number of received bytes for the flow (Rx Bytes)
	\item Rate of recieved bits for the flow (Throughput)
	\item Mean delay per recieved packet for the flow (Mean delay)
	\item Mean jitter per recieved packet for the flow (Mean jitter)
\end{itemize}

With the function \codeword{traceNodeContainerIPs} we additionally store which nodes -- identified by their IP address -- are assigned to which slice (and which nodes are the base stations) during the simulation.

Scenario 1 results in a flow file that looks like this:

\begin{verbatim}
Flow 1 (1.0.0.2:49153 -> 7.0.0.6:1234) proto UDP
  Tx Packets: 6000
  Tx Bytes:   768000
  TxOffered:  10.240000 Mbps
  Rx Bytes:   767104
  Throughput: 10.228053 Mbps
  Mean delay:  0.786401 ms
  Mean jitter:  0.119959 ms
  Rx Packets: 5993
Flow 2 (1.0.0.2:49154 -> 7.0.0.4:1235) proto UDP
  Tx Packets: 60
  Tx Bytes:   7680
  TxOffered:  0.102400 Mbps
  Rx Bytes:   7680
  Throughput: 0.102400 Mbps
  Mean delay:  1.756546 ms
  Mean jitter:  0.049405 ms
  Rx Packets: 60
Flow 3 (1.0.0.2:49155 -> 7.0.0.5:1235) proto UDP
  Tx Packets: 60
  Tx Bytes:   7680
  TxOffered:  0.102400 Mbps
  Rx Bytes:   7680
  Throughput: 0.102400 Mbps
  Mean delay:  1.827379 ms
  Mean jitter:  0.048810 ms
  Rx Packets: 60
Flow 4 (1.0.0.2:49156 -> 7.0.0.2:1236) proto UDP
  Tx Packets: 6000
  Tx Bytes:   768000
  TxOffered:  10.240000 Mbps
  Rx Bytes:   764160
  Throughput: 10.188800 Mbps
  Mean delay:  2.794291 ms
  Mean jitter:  0.179825 ms
  Rx Packets: 5970
Flow 5 (1.0.0.2:49157 -> 7.0.0.3:1236) proto UDP
  Tx Packets: 6000
  Tx Bytes:   768000
  TxOffered:  10.240000 Mbps
  Rx Bytes:   764160
  Throughput: 10.188800 Mbps
  Mean delay:  2.867154 ms
  Mean jitter:  0.179801 ms
  Rx Packets: 5970


  Mean flow throughput: 6.162091
  Mean flow delay: 2.006354

Nodes: 
  EMBB Slice: 
    7.0.0.2
    7.0.0.3
  MMTC Slice: 
    7.0.0.4
    7.0.0.5
  URLLC Slice: 
    7.0.0.6
  Ground Stations: 
    10.0.0.5
\end{verbatim}

\section{Trace data of all Device Operations with Packets}
Using the PointToPointHelper and the AsciiTraceHelper of ns-3, we create a .tr file that contains one trace event per line. 
The first character in that line describes the operation that happened on the device queue and can be one of these:
\begin{itemize}
    \item \texttt{+} enqueue
    \item \texttt{-} dequeue
    \item \texttt{d} packet dropped
    \item \texttt{r} packet received
\end{itemize}
The next value, separated with a space, is the current simulation time in seconds.
More details about this format can be found in the ns-3 tutorials. \footnote[11]{\url{https://www.nsnam.org/docs/release/3.9/tutorial/tutorial_23.html##:~:text=5.3.1.1}}

\section{Tracing and 5G New Radio}
\section{Visualization in NetAnim}








